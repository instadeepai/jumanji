
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation">
      
      
        <meta name="author" content="InstaDeep Research">
      
      
        <link rel="canonical" href="https://instadeepai.github.io/jumanji/api/environments/pac_man/">
      
      
        <link rel="prev" href="../mmst/">
      
      
        <link rel="next" href="../lbf/">
      
      
      <link rel="icon" href="../../../img/instadeep_logo.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.45">
    
    
      
        <title>PacMan - Jumanji</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../_static/custom.css">
    
      <link rel="stylesheet" href="../../../css/ansi-colours.css">
    
      <link rel="stylesheet" href="../../../css/pandas-dataframe.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#jumanji.environments.routing.pac_man.env.PacMan" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Jumanji" class="md-header__button md-logo" aria-label="Jumanji" data-md-component="logo">
      
  <img src="../../../img/instadeep_logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Jumanji
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              PacMan
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="lime"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/instadeepai/jumanji" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    instadeepai/jumanji
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../environments/game_2048/" class="md-tabs__link">
          
  
    
  
  Environments

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../guides/advanced_usage/" class="md-tabs__link">
          
  
    
  
  User Guides

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../env/" class="md-tabs__link">
          
  
    
  
  API Reference

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Jumanji" class="md-nav__button md-logo" aria-label="Jumanji" data-md-component="logo">
      
  <img src="../../../img/instadeep_logo.png" alt="logo">

    </a>
    Jumanji
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/instadeepai/jumanji" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    instadeepai/jumanji
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Environments
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Environments
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Logic
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Logic
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../environments/game_2048/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Game2048
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../environments/graph_coloring/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GraphColoring
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../environments/minesweeper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Minesweeper
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../environments/rubiks_cube/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RubiksCube
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../environments/sliding_tile_puzzle/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SlidingTilePuzzle
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../environments/sudoku/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sudoku
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Packing
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Packing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../environments/bin_pack/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BinPack
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../environments/flat_pack/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FlatPack
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../environments/job_shop/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JobShop
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../environments/knapsack/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Knapsack
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../environments/tetris/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tetris
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Routing
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Routing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../environments/cleaner/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cleaner
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../environments/connector/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Connector
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../environments/cvrp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CVRP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../environments/maze/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Maze
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../environments/mmst/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MMST
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../environments/multi_cvrp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MultiCVRP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../environments/pac_man/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PacMan
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../environments/robot_warehouse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RobotWarehouse
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../environments/lbf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Level-Based Foraging
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../environments/sokoban/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sokoban
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../environments/snake/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Snake
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../environments/tsp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TSP
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    User Guides
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            User Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/advanced_usage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Advanced Usage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/registration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Registration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/training/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Training
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/wrappers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wrapper
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" checked>
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Environments
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            Environments
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../env/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Base
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_2" >
        
          
          <label class="md-nav__link" for="__nav_4_1_2" id="__nav_4_1_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Logic
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_2">
            <span class="md-nav__icon md-icon"></span>
            Logic
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../game_2048/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Game2048
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph_coloring/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GraphColoring
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../minesweeper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Minesweeper
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rubiks_cube/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RubiksCube
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sliding_tile_puzzle/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SlidingTilePuzzle
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sudoku/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sudoku
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_3" >
        
          
          <label class="md-nav__link" for="__nav_4_1_3" id="__nav_4_1_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Packing
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_3">
            <span class="md-nav__icon md-icon"></span>
            Packing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bin_pack/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BinPack
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../flat_pack/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FlatPack
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../job_shop/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JobShop
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../knapsack/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Knapsack
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tetris/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tetris
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4_1_4" id="__nav_4_1_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Routing
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_1_4">
            <span class="md-nav__icon md-icon"></span>
            Routing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cleaner/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cleaner
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../connector/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Connector
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cvrp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CVRP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maze/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Maze
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mmst/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MMST
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../multi_cvrp.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MultiCVRP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    PacMan
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    PacMan
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#jumanji.environments.routing.pac_man.env.PacMan" class="md-nav__link">
    <span class="md-ellipsis">
      PacMan
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jumanji.environments.routing.pac_man.env.PacMan.action_spec" class="md-nav__link">
    <span class="md-ellipsis">
      action_spec
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jumanji.environments.routing.pac_man.env.PacMan.observation_spec" class="md-nav__link">
    <span class="md-ellipsis">
      observation_spec
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jumanji.environments.routing.pac_man.env.PacMan.animate" class="md-nav__link">
    <span class="md-ellipsis">
      animate
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jumanji.environments.routing.pac_man.env.PacMan.check_power_up" class="md-nav__link">
    <span class="md-ellipsis">
      check_power_up
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jumanji.environments.routing.pac_man.env.PacMan.check_rewards" class="md-nav__link">
    <span class="md-ellipsis">
      check_rewards
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jumanji.environments.routing.pac_man.env.PacMan.check_wall_collisions" class="md-nav__link">
    <span class="md-ellipsis">
      check_wall_collisions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jumanji.environments.routing.pac_man.env.PacMan.close" class="md-nav__link">
    <span class="md-ellipsis">
      close
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jumanji.environments.routing.pac_man.env.PacMan.player_step" class="md-nav__link">
    <span class="md-ellipsis">
      player_step
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jumanji.environments.routing.pac_man.env.PacMan.render" class="md-nav__link">
    <span class="md-ellipsis">
      render
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jumanji.environments.routing.pac_man.env.PacMan.reset" class="md-nav__link">
    <span class="md-ellipsis">
      reset
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jumanji.environments.routing.pac_man.env.PacMan.step" class="md-nav__link">
    <span class="md-ellipsis">
      step
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../robot_warehouse.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RobotWarehouse
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lbf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Level-Based Foraging
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sokoban/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sokoban
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../snake/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Snake
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tsp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TSP
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../wrappers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wrappers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../types/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Types
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>PacMan</h1>

<div class="doc doc-object doc-class">



<a id="jumanji.environments.routing.pac_man.env.PacMan"></a>
    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="jumanji.env.Environment" href="../../env/#jumanji.env.Environment">Environment</a>[<span title="jumanji.environments.routing.pac_man.types.State">State</span>, <span title="jumanji.specs.DiscreteArray">DiscreteArray</span>, <span title="jumanji.environments.routing.pac_man.types.Observation">Observation</span>]</code></p>


        <p>A JAX implementation of the 'PacMan' game where a single agent must navigate a
maze to collect pellets and avoid 4 heuristic agents. The game takes place on a 31x28
grid where the player can move in 4 directions (left, right, up, down) and collect
pellets to gain points. The goal is to collect all of the pellets on the board without
colliding with one of the heuristic agents. Using the AsciiGenerator the environment
will always generate the same maze as long as the same Ascii diagram is in use.</p>
<ul>
<li>
<p>observation: <code>Observation</code></p>
<ul>
<li>player_locations: current 2D position of agent.</li>
<li>grid: jax array (int) of the ingame maze with walls.</li>
<li>ghost_locations: jax array (int) of ghost positions.</li>
<li>power_up_locations: jax array (int) of power-pellet locations</li>
<li>pellet_locations: jax array (int) of pellets.</li>
<li>action_mask: jax array (bool) defining current actions.</li>
<li>score: (int32) of total points aquired.</li>
</ul>
</li>
<li>
<p>action: jax array (int) of shape () specifiying which action to take [0,1,2,3,4]
    corresponding to [up, right, down, left, no-op. If there is an invalid action
    taken, i.e. there is a wall blocking the action, then no action (no-op) is taken.</p>
</li>
<li>
<p>reward: jax array (float32) of shape (): 10 per pellet collected, 20 for a power pellet
    and 200 for each unique ghost eaten.</p>
</li>
<li>
<p>episode termination (if any):</p>
<ul>
<li>agent has collected all pellets.</li>
<li>agent killed by ghost.</li>
<li>timer has elapsed.</li>
</ul>
</li>
<li>
<p>state: State:</p>
<ul>
<li>key: jax array (uint32) of shape(2,).</li>
<li>grid: jax array (int)) of shape (31,28) of the ingame maze with walls.</li>
<li>pellets: int tracking the number of pellets.</li>
<li>frightened_state_time: jax array (int) of shape ()
    tracks number of steps for the scatter state.</li>
<li>pellet_locations: jax array (int) of pellets of shape (316,2).</li>
<li>power_up_locations: jax array (int) of power-pellet locations of shape (4,2).</li>
<li>player_locations: current 2D position of agent.</li>
<li>ghost_locations: jax array (int) of ghost positions of shape (4,2).</li>
<li>initial_player_locations: starting 2D position of agent.</li>
<li>initial_ghost_positions: jax array (int) of ghost positions of shape (4,2).</li>
<li>ghost_init_targets: jax array (int) of ghost positions.
    used to direct ghosts on respawn.</li>
<li>old_ghost_locations: jax array (int) of shape (4,2) of ghost positions from last step.
    used to prevent ghost backtracking.</li>
<li>ghost_init_steps: jax array (int) of shape (4,2) number of initial ghost steps.
    used to determine per ghost initialisation.</li>
<li>ghost_actions: jax array (int) of shape (4,).</li>
<li>last_direction: int tracking the last direction of the player.</li>
<li>dead: bool used to track player death.</li>
<li>visited_index: jax array (int) of visited locations of shape (320,2).
    used to prevent repeated pellet points.</li>
<li>ghost_starts: jax array (int) of shape (4,2)
    used to reset ghost positions if eaten</li>
<li>scatter_targets: jax array (int) of shape (4,2)
    target locations for ghosts when scatter behavior is active.</li>
<li>step_count: (int32) of total steps taken from reset till current timestep.</li>
<li>ghost_eaten: jax array (bool)of shape (4,) tracking if ghost has been eaten before.</li>
<li>score: (int32) of total points aquired.</li>
</ul>
</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">jumanji.environments</span> <span class="kn">import</span> <span class="n">pac_man</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">PacMan</span><span class="p">()</span>
<span class="n">key</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">state</span><span class="p">,</span> <span class="n">timestep</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">jit</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">)(</span><span class="n">key</span><span class="p">)</span>
<span class="n">env</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
<span class="n">action</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">action_spec</span><span class="o">.</span><span class="n">generate_value</span><span class="p">()</span>
<span class="n">state</span><span class="p">,</span> <span class="n">timestep</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">jit</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">)(</span><span class="n">state</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>
<span class="n">env</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>

        <p>Instantiates a <code>PacMan</code> environment.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>generator</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="jumanji.environments.routing.pac_man.generator.Generator">Generator</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>Generator</code> whose <code>__call__</code> instantiates an environment instance.
Implemented options are [<code>AsciiGenerator</code>].</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>time_limit</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[int]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the time_limit of an episode, i.e. the maximum number of environment steps
before the episode terminates. By default, set to 1000.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>viewer</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="jumanji.viewer.Viewer">Viewer</span>[<span title="jumanji.environments.routing.pac_man.types.State">State</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>Viewer</code> used for rendering. Defaults to <code>PacManViewer</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>






                  <details class="quote">
                    <summary>Source code in <code>jumanji/environments/routing/pac_man/env.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">generator</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Generator</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">viewer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Viewer</span><span class="p">[</span><span class="n">State</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">time_limit</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Instantiates a `PacMan` environment.</span>

<span class="sd">    Args:</span>
<span class="sd">        generator: `Generator` whose `__call__` instantiates an environment instance.</span>
<span class="sd">            Implemented options are [`AsciiGenerator`].</span>
<span class="sd">        time_limit: the time_limit of an episode, i.e. the maximum number of environment steps</span>
<span class="sd">            before the episode terminates. By default, set to 1000.</span>
<span class="sd">        viewer: `Viewer` used for rendering. Defaults to `PacManViewer`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">generator</span> <span class="o">=</span> <span class="n">generator</span> <span class="ow">or</span> <span class="n">AsciiGenerator</span><span class="p">(</span><span class="n">DEFAULT_MAZE</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">x_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generator</span><span class="o">.</span><span class="n">x_size</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">y_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generator</span><span class="o">.</span><span class="n">y_size</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pellet_spaces</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generator</span><span class="o">.</span><span class="n">pellet_spaces</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_viewer</span> <span class="o">=</span> <span class="n">viewer</span> <span class="ow">or</span> <span class="n">PacManViewer</span><span class="p">(</span><span class="s2">&quot;Pacman&quot;</span><span class="p">,</span> <span class="n">render_mode</span><span class="o">=</span><span class="s2">&quot;human&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">time_limit</span> <span class="o">=</span> <span class="mi">1000</span> <span class="ow">or</span> <span class="n">time_limit</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="jumanji.environments.routing.pac_man.env.PacMan.action_spec" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">action_spec</span><span class="p">:</span> <span class="n">specs</span><span class="o">.</span><span class="n">DiscreteArray</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#jumanji.environments.routing.pac_man.env.PacMan.action_spec" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">

        <p>Returns the action spec.</p>
<p>5 actions: [0,1,2,3,4] -&gt; [Up, Right, Down, Left, No-op].</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>action_spec</code></td>            <td>
                  <code><span title="jumanji.specs.DiscreteArray">DiscreteArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a <code>specs.DiscreteArray</code> spec object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="jumanji.environments.routing.pac_man.env.PacMan.observation_spec" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">observation_spec</span><span class="p">:</span> <span class="n">specs</span><span class="o">.</span><span class="n">Spec</span><span class="p">[</span><span class="n">Observation</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#jumanji.environments.routing.pac_man.env.PacMan.observation_spec" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">

        <p>Specifications of the observation of the <code>PacMan</code> environment.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jumanji.specs.Spec">Spec</span>[<span title="jumanji.environments.routing.pac_man.types.Observation">Observation</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Spec containing all the specifications for all the <code>Observation</code> fields:</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jumanji.specs.Spec">Spec</span>[<span title="jumanji.environments.routing.pac_man.types.Observation">Observation</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>player_locations: tree of BoundedArray (int32) of shape ().</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jumanji.specs.Spec">Spec</span>[<span title="jumanji.environments.routing.pac_man.types.Observation">Observation</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>grid: BoundedArray (int)) of the ingame maze with walls.</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jumanji.specs.Spec">Spec</span>[<span title="jumanji.environments.routing.pac_man.types.Observation">Observation</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>ghost_locations: jax array (int) of ghost positions.</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jumanji.specs.Spec">Spec</span>[<span title="jumanji.environments.routing.pac_man.types.Observation">Observation</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>power_up_locations: jax array (int) of power-pellet locations</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jumanji.specs.Spec">Spec</span>[<span title="jumanji.environments.routing.pac_man.types.Observation">Observation</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>pellet_locations: jax array (int) of pellet locations.</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jumanji.specs.Spec">Spec</span>[<span title="jumanji.environments.routing.pac_man.types.Observation">Observation</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>action_mask: jax array (bool) defining current actions.</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jumanji.specs.Spec">Spec</span>[<span title="jumanji.environments.routing.pac_man.types.Observation">Observation</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>frightened_state_time: int counting time remaining in
scatter mode.</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jumanji.specs.Spec">Spec</span>[<span title="jumanji.environments.routing.pac_man.types.Observation">Observation</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>score: (int) of total score obtained by player.</li>
</ul>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
    </div>

</div>



<div class="doc doc-object doc-function">


<h2 id="jumanji.environments.routing.pac_man.env.PacMan.animate" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">animate</span><span class="p">(</span><span class="n">states</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">save_path</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#jumanji.environments.routing.pac_man.env.PacMan.animate" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">

        <p>Creates an animated gif of the <code>Maze</code> environment based on the sequence of states.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>states</code>
            </td>
            <td>
                  <code><span title="typing.Sequence">Sequence</span>[<span title="jumanji.environments.routing.pac_man.types.State">State</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>sequence of environment states corresponding to consecutive timesteps.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>interval</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>delay between frames in milliseconds, default to 200.</p>
              </div>
            </td>
            <td>
                  <code>200</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>save_path</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the path where the animation file should be saved. If it is None, the plot
will not be saved.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="matplotlib.animation.FuncAnimation">FuncAnimation</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>animation.FuncAnimation: the animation object that was created.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>jumanji/environments/routing/pac_man/env.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">animate</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">states</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">State</span><span class="p">],</span>
    <span class="n">interval</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span>
    <span class="n">save_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">animation</span><span class="o">.</span><span class="n">FuncAnimation</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates an animated gif of the `Maze` environment based on the sequence of states.</span>

<span class="sd">    Args:</span>
<span class="sd">        states: sequence of environment states corresponding to consecutive timesteps.</span>
<span class="sd">        interval: delay between frames in milliseconds, default to 200.</span>
<span class="sd">        save_path: the path where the animation file should be saved. If it is None, the plot</span>
<span class="sd">            will not be saved.</span>

<span class="sd">    Returns:</span>
<span class="sd">        animation.FuncAnimation: the animation object that was created.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_viewer</span><span class="o">.</span><span class="n">animate</span><span class="p">(</span><span class="n">states</span><span class="p">,</span> <span class="n">interval</span><span class="p">,</span> <span class="n">save_path</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jumanji.environments.routing.pac_man.env.PacMan.check_power_up" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_power_up</span><span class="p">(</span><span class="n">state</span><span class="p">)</span></code>

<a href="#jumanji.environments.routing.pac_man.env.PacMan.check_power_up" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">

        <p>Check if the player is on a power-up location and update the power-up
locations array accordingly.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>state</code>
            </td>
            <td>
                  <code><span title="jumanji.environments.routing.pac_man.types.State">State</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>'state` object corresponding to the new state of the environment</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>power_up_locations</code></td>            <td>
                  <code><span title="chex.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>locations of the remaining power-ups</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>eat</code></td>            <td>
                  <code><span title="chex.Numeric">Numeric</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a bool indicating if the player can eat the ghosts</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>reward</code></td>            <td>
                  <code><span title="chex.Numeric">Numeric</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>an int of the reward gained from collecting power-ups</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>jumanji/environments/routing/pac_man/env.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_power_up</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">State</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">chex</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span> <span class="n">chex</span><span class="o">.</span><span class="n">Numeric</span><span class="p">,</span> <span class="n">chex</span><span class="o">.</span><span class="n">Numeric</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check if the player is on a power-up location and update the power-up</span>
<span class="sd">    locations array accordingly.</span>

<span class="sd">    Args:</span>
<span class="sd">        state: &#39;state` object corresponding to the new state of the environment</span>

<span class="sd">    Returns:</span>
<span class="sd">        power_up_locations: locations of the remaining power-ups</span>
<span class="sd">        eat: a bool indicating if the player can eat the ghosts</span>
<span class="sd">        reward: an int of the reward gained from collecting power-ups</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">power_up_locations</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">power_up_locations</span><span class="p">)</span>

    <span class="n">player_space</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">player_locations</span>
    <span class="n">player_loc_x</span> <span class="o">=</span> <span class="n">player_space</span><span class="o">.</span><span class="n">x</span>
    <span class="n">player_loc_y</span> <span class="o">=</span> <span class="n">player_space</span><span class="o">.</span><span class="n">y</span>
    <span class="n">player_loc</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">player_loc_y</span><span class="p">,</span> <span class="n">player_loc_x</span><span class="p">])</span>

    <span class="c1"># Check if player and power_up position are shared</span>
    <span class="n">on_powerup</span> <span class="o">=</span> <span class="p">(</span><span class="n">player_loc</span> <span class="o">==</span> <span class="n">power_up_locations</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
    <span class="n">eat</span> <span class="o">=</span> <span class="n">on_powerup</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">player_loc</span> <span class="o">==</span> <span class="n">power_up_locations</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">invert_mask</span> <span class="o">=</span> <span class="o">~</span><span class="n">mask</span>
    <span class="n">invert_mask</span> <span class="o">=</span> <span class="n">invert_mask</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Mask out collected power-ups</span>
    <span class="n">power_up_locations</span> <span class="o">=</span> <span class="n">power_up_locations</span> <span class="o">*</span> <span class="n">invert_mask</span>

    <span class="c1"># Assign reward for power-up</span>
    <span class="n">reward</span> <span class="o">=</span> <span class="n">eat</span> <span class="o">*</span> <span class="mf">50.0</span>

    <span class="k">return</span> <span class="n">power_up_locations</span><span class="p">,</span> <span class="n">eat</span><span class="p">,</span> <span class="n">reward</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jumanji.environments.routing.pac_man.env.PacMan.check_rewards" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_rewards</span><span class="p">(</span><span class="n">state</span><span class="p">)</span></code>

<a href="#jumanji.environments.routing.pac_man.env.PacMan.check_rewards" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">

        <p>Process the state of the game to compute rewards, updated pellet spaces, and remaining
number of pellets.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>state</code>
            </td>
            <td>
                  <code><span title="jumanji.environments.routing.pac_man.types.State">State</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>'State` object corresponding to the current state of the environment</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>rewards</code></td>            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>an integer representing the reward earned by the player in the current state</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>pellet_spaces</code></td>            <td>
                  <code><span title="chex.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a 2D jax array showing the location of all remaining cookies</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>num_cookies</code></td>            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>an integer counting the remaining cookies on the map.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>jumanji/environments/routing/pac_man/env.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_rewards</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">State</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">chex</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Process the state of the game to compute rewards, updated pellet spaces, and remaining</span>
<span class="sd">    number of pellets.</span>

<span class="sd">    Args:</span>
<span class="sd">        state: &#39;State` object corresponding to the current state of the environment</span>

<span class="sd">    Returns:</span>
<span class="sd">        rewards: an integer representing the reward earned by the player in the current state</span>
<span class="sd">        pellet_spaces: a 2D jax array showing the location of all remaining cookies</span>
<span class="sd">        num_cookies: an integer counting the remaining cookies on the map.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Get the locations of the pellets and the player</span>
    <span class="n">pellet_spaces</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">pellet_locations</span><span class="p">)</span>
    <span class="n">player_space</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">player_locations</span>
    <span class="n">ps</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">player_space</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">player_space</span><span class="o">.</span><span class="n">x</span><span class="p">])</span>

    <span class="c1"># Get the number of pellets on the map</span>
    <span class="n">num_pellets</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">pellets</span>

    <span class="c1"># Check if player has eaten a pellet in this step</span>
    <span class="n">ate_pellet</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">ps</span> <span class="o">==</span> <span class="n">pellet_spaces</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">))</span>

    <span class="c1"># Reduce number of pellets on map if eaten, add reward and remove eaten pellet</span>
    <span class="n">num_pellets</span> <span class="o">-=</span> <span class="n">ate_pellet</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">rewards</span> <span class="o">=</span> <span class="n">ate_pellet</span> <span class="o">*</span> <span class="mf">10.0</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">logical_not</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">ps</span> <span class="o">==</span> <span class="n">pellet_spaces</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">pellet_spaces</span> <span class="o">=</span> <span class="n">pellet_spaces</span> <span class="o">*</span> <span class="n">mask</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">rewards</span><span class="p">,</span> <span class="n">pellet_spaces</span><span class="p">,</span> <span class="n">num_pellets</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jumanji.environments.routing.pac_man.env.PacMan.check_wall_collisions" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_wall_collisions</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">new_player_pos</span><span class="p">)</span></code>

<a href="#jumanji.environments.routing.pac_man.env.PacMan.check_wall_collisions" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">

        <p>Check if the new player position collides with a wall.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>state</code>
            </td>
            <td>
                  <code><span title="jumanji.environments.routing.pac_man.types.State">State</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>'State` object corresponding to the new state of the environment.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>new_player_pos</code>
            </td>
            <td>
                  <code><span title="jumanji.environments.routing.pac_man.types.Position">Position</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the position of the player after the last action.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>collision</code></td>            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a boolean indicating if the player has moved into a wall.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>jumanji/environments/routing/pac_man/env.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_wall_collisions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">State</span><span class="p">,</span> <span class="n">new_player_pos</span><span class="p">:</span> <span class="n">Position</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check if the new player position collides with a wall.</span>

<span class="sd">    Args:</span>
<span class="sd">        state: &#39;State` object corresponding to the new state of the environment.</span>
<span class="sd">        new_player_pos: the position of the player after the last action.</span>

<span class="sd">    Returns:</span>
<span class="sd">        collision: a boolean indicating if the player has moved into a wall.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">grid</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">grid</span>
    <span class="n">location_value</span> <span class="o">=</span> <span class="n">grid</span><span class="p">[</span><span class="n">new_player_pos</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">new_player_pos</span><span class="o">.</span><span class="n">y</span><span class="p">]</span>

    <span class="n">collision</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">lax</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span>
        <span class="n">location_value</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span>
        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">new_player_pos</span><span class="p">,</span>
        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">state</span><span class="o">.</span><span class="n">player_locations</span><span class="p">,</span>
        <span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">collision</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jumanji.environments.routing.pac_man.env.PacMan.close" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">close</span><span class="p">()</span></code>

<a href="#jumanji.environments.routing.pac_man.env.PacMan.close" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">

        <p>Perform any necessary cleanup.</p>
<p>Environments will automatically :meth:<code>close()</code> themselves when
garbage collected or when the program exits.</p>

            <details class="quote">
              <summary>Source code in <code>jumanji/environments/routing/pac_man/env.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Perform any necessary cleanup.</span>

<span class="sd">    Environments will automatically :meth:`close()` themselves when</span>
<span class="sd">    garbage collected or when the program exits.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_viewer</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jumanji.environments.routing.pac_man.env.PacMan.player_step" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">player_step</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>

<a href="#jumanji.environments.routing.pac_man.env.PacMan.player_step" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">

        <p>Compute the new position of the player based on the given state and action.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>state</code>
            </td>
            <td>
                  <code><span title="jumanji.environments.routing.pac_man.types.State">State</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>'state` object corresponding to the new state of the environment.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>action</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>an integer between 0 and 4 representing the player's chosen action.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>steps</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>how many steps ahead of current position to search.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>new_pos</code></td>            <td>
                  <code><span title="jumanji.environments.routing.pac_man.types.Position">Position</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a <code>Position</code> object representing the new position of the player.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>jumanji/environments/routing/pac_man/env.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">player_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">State</span><span class="p">,</span> <span class="n">action</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Position</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the new position of the player based on the given state and action.</span>

<span class="sd">    Args:</span>
<span class="sd">        state: &#39;state` object corresponding to the new state of the environment.</span>
<span class="sd">        action: an integer between 0 and 4 representing the player&#39;s chosen action.</span>
<span class="sd">        steps: how many steps ahead of current position to search.</span>

<span class="sd">    Returns:</span>
<span class="sd">        new_pos: a `Position` object representing the new position of the player.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">position</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">player_locations</span>

    <span class="n">move_left</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">position</span><span class="p">:</span> <span class="p">(</span><span class="n">position</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">position</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">steps</span><span class="p">)</span>
    <span class="n">move_up</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">position</span><span class="p">:</span> <span class="p">(</span><span class="n">position</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">steps</span><span class="p">,</span> <span class="n">position</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
    <span class="n">move_right</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">position</span><span class="p">:</span> <span class="p">(</span><span class="n">position</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">position</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">steps</span><span class="p">)</span>
    <span class="n">move_down</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">position</span><span class="p">:</span> <span class="p">(</span><span class="n">position</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="n">steps</span><span class="p">,</span> <span class="n">position</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
    <span class="n">no_op</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">position</span><span class="p">:</span> <span class="p">(</span><span class="n">position</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">position</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>

    <span class="n">new_pos_row</span><span class="p">,</span> <span class="n">new_pos_col</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">lax</span><span class="o">.</span><span class="n">switch</span><span class="p">(</span>
        <span class="n">action</span><span class="p">,</span> <span class="p">[</span><span class="n">move_left</span><span class="p">,</span> <span class="n">move_up</span><span class="p">,</span> <span class="n">move_right</span><span class="p">,</span> <span class="n">move_down</span><span class="p">,</span> <span class="n">no_op</span><span class="p">],</span> <span class="n">position</span>
    <span class="p">)</span>

    <span class="n">new_pos</span> <span class="o">=</span> <span class="n">Position</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">new_pos_col</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_size</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">new_pos_row</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_size</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">new_pos</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jumanji.environments.routing.pac_man.env.PacMan.render" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">render</span><span class="p">(</span><span class="n">state</span><span class="p">)</span></code>

<a href="#jumanji.environments.routing.pac_man.env.PacMan.render" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">

        <p>Render the given state of the environment.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>state</code>
            </td>
            <td>
                  <code><span title="jumanji.environments.routing.pac_man.types.State">State</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>state</code> object containing the current environment state.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>jumanji/environments/routing/pac_man/env.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">State</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Render the given state of the environment.</span>

<span class="sd">    Args:</span>
<span class="sd">        state: `state` object containing the current environment state.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_viewer</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jumanji.environments.routing.pac_man.env.PacMan.reset" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reset</span><span class="p">(</span><span class="n">key</span><span class="p">)</span></code>

<a href="#jumanji.environments.routing.pac_man.env.PacMan.reset" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">

        <p>Resets the environment by calling the instance generator for a new instance.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>key</code>
            </td>
            <td>
                  <code><span title="chex.PRNGKey">PRNGKey</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A PRNGKey to use for random number generation.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>state</code></td>            <td>
                  <code><span title="jumanji.environments.routing.pac_man.types.State">State</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>State</code> object corresponding to the new state of the environment after a reset.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>timestep</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="jumanji.types.TimeStep" href="../../types/#jumanji.types.TimeStep">TimeStep</a>[<span title="jumanji.environments.routing.pac_man.types.Observation">Observation</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>TimeStep</code> object corresponding the first timestep returned by the environment
after a reset.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>jumanji/environments/routing/pac_man/env.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">PRNGKey</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">State</span><span class="p">,</span> <span class="n">TimeStep</span><span class="p">[</span><span class="n">Observation</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Resets the environment by calling the instance generator for a new instance.</span>

<span class="sd">    Args:</span>
<span class="sd">        key: A PRNGKey to use for random number generation.</span>

<span class="sd">    Returns:</span>
<span class="sd">        state: `State` object corresponding to the new state of the environment after a reset.</span>
<span class="sd">        timestep: `TimeStep` object corresponding the first timestep returned by the environment</span>
<span class="sd">            after a reset.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generator</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

    <span class="c1"># Generate observation</span>
    <span class="n">obs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_observation_from_state</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>

    <span class="c1"># Return a restart timestep of step type is FIRST.</span>
    <span class="n">timestep</span> <span class="o">=</span> <span class="n">restart</span><span class="p">(</span><span class="n">observation</span><span class="o">=</span><span class="n">obs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">state</span><span class="p">,</span> <span class="n">timestep</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="jumanji.environments.routing.pac_man.env.PacMan.step" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">step</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span></code>

<a href="#jumanji.environments.routing.pac_man.env.PacMan.step" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">

        <p>Run one timestep of the environment's dynamics.</p>
<p>If an action is invalid, the agent does not move, i.e. the episode does not
automatically terminate.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>state</code>
            </td>
            <td>
                  <code><span title="jumanji.environments.routing.pac_man.types.State">State</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>State object containing the dynamics of the environment.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>action</code>
            </td>
            <td>
                  <code><span title="chex.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>(int32) specifying which action to take: [0,1,2,3,4] correspond to
[Up, Right, Down, Left, No-op]. If an invalid action is taken, i.e. there is a wall
blocking the action, then no action (no-op) is taken.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>state</code></td>            <td>
                  <code><span title="jumanji.environments.routing.pac_man.types.State">State</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the new state of the environment.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="jumanji.types.TimeStep" href="../../types/#jumanji.types.TimeStep">TimeStep</a>[<span title="jumanji.environments.routing.pac_man.types.Observation">Observation</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the next timestep to be observed.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>jumanji/environments/routing/pac_man/env.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">State</span><span class="p">,</span> <span class="n">action</span><span class="p">:</span> <span class="n">chex</span><span class="o">.</span><span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">State</span><span class="p">,</span> <span class="n">TimeStep</span><span class="p">[</span><span class="n">Observation</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Run one timestep of the environment&#39;s dynamics.</span>

<span class="sd">    If an action is invalid, the agent does not move, i.e. the episode does not</span>
<span class="sd">    automatically terminate.</span>

<span class="sd">    Args:</span>
<span class="sd">        state: State object containing the dynamics of the environment.</span>
<span class="sd">        action: (int32) specifying which action to take: [0,1,2,3,4] correspond to</span>
<span class="sd">            [Up, Right, Down, Left, No-op]. If an invalid action is taken, i.e. there is a wall</span>
<span class="sd">            blocking the action, then no action (no-op) is taken.</span>

<span class="sd">    Returns:</span>
<span class="sd">        state: the new state of the environment.</span>
<span class="sd">        the next timestep to be observed.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Collect updated state based on environment dynamics</span>
    <span class="n">updated_state</span><span class="p">,</span> <span class="n">collision_rewards</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_state</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>

    <span class="c1"># Create next_state from updated state</span>
    <span class="n">next_state</span> <span class="o">=</span> <span class="n">updated_state</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">step_count</span><span class="o">=</span><span class="n">state</span><span class="o">.</span><span class="n">step_count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

    <span class="c1"># Check if episode terminates</span>
    <span class="n">num_pellets</span> <span class="o">=</span> <span class="n">next_state</span><span class="o">.</span><span class="n">pellets</span>
    <span class="n">dead</span> <span class="o">=</span> <span class="n">next_state</span><span class="o">.</span><span class="n">dead</span>
    <span class="n">time_limit_exceeded</span> <span class="o">=</span> <span class="n">next_state</span><span class="o">.</span><span class="n">step_count</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_limit</span>
    <span class="n">all_pellets_found</span> <span class="o">=</span> <span class="n">num_pellets</span> <span class="o">==</span> <span class="mi">0</span>
    <span class="n">dead</span> <span class="o">=</span> <span class="n">next_state</span><span class="o">.</span><span class="n">dead</span> <span class="o">==</span> <span class="mi">1</span>
    <span class="n">done</span> <span class="o">=</span> <span class="n">time_limit_exceeded</span> <span class="o">|</span> <span class="n">dead</span> <span class="o">|</span> <span class="n">all_pellets_found</span>

    <span class="n">reward</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">collision_rewards</span><span class="p">)</span>
    <span class="c1"># Generate observation from the state</span>
    <span class="n">observation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_observation_from_state</span><span class="p">(</span><span class="n">next_state</span><span class="p">)</span>

    <span class="c1"># Return either a MID or a LAST timestep depending on done.</span>
    <span class="n">timestep</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">lax</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span>
        <span class="n">done</span><span class="p">,</span>
        <span class="n">termination</span><span class="p">,</span>
        <span class="n">transition</span><span class="p">,</span>
        <span class="n">reward</span><span class="p">,</span>
        <span class="n">observation</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">next_state</span><span class="p">,</span> <span class="n">timestep</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    2024-12-09
  </span>

    
    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      InstaDeep © 2022 Copyright, all rights reserved.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tracking", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.indexes", "search.highlight", "search.share", "search.suggest", "toc.integrate", "toc.follow", "content.code.annotate", "navigation.tabs", "navigation.top"], "search": "../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
    
  </body>
</html>